<aside class="nav-rail">
    <div class="rail-top">
        <a class="rail-logo" href="/">
            <img src="/assets/images/logo33labs2.png" alt="33LABS" />
        </a>
        <div id="sideMenuArrow" class="side-menu-arrow" title="Expand / Collapse">
            <img src="/assets/images/side-menu-arrow4x.png" alt="Side Menu" class="arrow-icon">
        </div>
        <nav class="rail-nav">
             <!-- User Management -->
             <div class="nav-item">
                <a class="rail-btn" href="/aligners-cases" title="Aligner Cases">
                    <img src="/assets/images/nav-icon.svg" alt="Home" class="icon-default" />
                    <img src="/assets/images/nav-icon-hover.svg" alt="Home" class="icon-hover" />
                    <span class="btn-text">Manage Cases</span>
                </a>
                <div class="nav-dropdown">
                    <a href="/aligners-cases" class="menu-item">Manage Cases</a>
                </div>
            </div>
            <!-- Cases (Expandable) -->
            <div class="nav-item expandable">
                <a href="#" class="rail-btn expandable-btn" title="Cases" style="display:flex; align-items:center; gap:12px;">
                    <img src="/assets/images/add-case-icon.svg" alt="Aligner Cases" class="icon-default" />
                    <img src="/assets/images/add-case-icon-hover.svg" alt="Aligner Cases" class="icon-hover" />
                    <span class="btn-text">Create Cases</span>
                    <img class="chevron-icon" src="/assets/images/chevron-down-arrow.svg" alt="Toggle" />
                </a>
                <!-- Hover dropdown when collapsed -->
                <div class="nav-dropdown hover-dropdown">
                    <a href="/add-case" class="menu-item">Add New Case</a>
                    <a href="/upload-stl" class="menu-item">Upload STL</a>
                </div>
                <!-- Inline menu when expanded -->
                <div class="expanded-menu">
                    <a href="/add-case" class="menu-item">Add New Case</a>
                    <a href="/upload-stl" class="menu-item">Upload STL</a>
                </div>
            </div>

            <!-- User Management -->
            <div class="nav-item" id="userManagementNav" data-user-role="<%= user && user[0] ? user[0].role : '' %>">
                <a class="rail-btn" href="/user-management" title="User Management">
                    <img src="/assets/images/user-management-icon.svg" alt="Users" class="icon-default" />
                    <img src="/assets/images/user-management-icon-hover.svg" alt="Users" class="icon-hover" />
                    <span class="btn-text">User Management</span>
                </a>
                <div class="nav-dropdown">
                    <a href="/user-management" class="menu-item">Manage Users</a>
                </div>
            </div>
        </nav>
    </div>
    <div class="rail-bottom">
        <!-- Language selector -->
        <div class="menu-container language-container">
            <div id="languageFab" class="language-fab" title="Language">
                <span class="flag-placeholder">
                    <img src="/assets/images/msia-flag.png" alt="English" />
                </span>
                <span class="language-text">English</span>
            </div>
            <div id="languageMenu" class="dropdown-menu language-menu">
                <button class="menu-item lang-item active">
                    <img src="/assets/images/msia-flag.png" alt="English" class="lang-flag" />
                    <span>English</span>
                </button>
                <button class="menu-item lang-item">
                    <img src="/assets/images/thai-flag.png" alt="Thai" class="lang-flag" />
                    <span>Thai</span>
                </button>
            </div>
        </div>
        <!-- User menu -->
        <div class="menu-container user-container">
            <button id="userBtn" class="user-fab" title="Account">
                <span class="user-initial"><%= user[0].fullName.charAt(0) %></span>
                <span class="user-name"><%= user[0].fullName %></span>
            </button>
            <div id="userMenu" class="dropdown-menu user-menu-dropdown">
                <a href="/profile" class="menu-item">Profile</a>
                <button class="menu-item logout-item" id="logoutBtn">Logout</button>
            </div>
        </div>
    </div>
</aside>

